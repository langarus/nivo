"use strict";var e=require("react"),r=require("@nivo/core"),t=require("d3-shape"),o=require("d3-scale"),n=require("@nivo/colors"),a=require("@nivo/annotations"),i=require("@nivo/tooltip"),s=require("react/jsx-runtime"),u=require("lodash/isPlainObject"),p=require("lodash/get"),l=require("@react-spring/web");function d(){return d=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},d.apply(this,arguments)}var c={layers:["separators","parts","labels","annotations"],direction:"vertical",interpolation:"smooth",spacing:0,shapeBlending:.66,colors:{scheme:"nivo"},size:void 0,fillOpacity:1,borderWidth:6,borderColor:{from:"color"},borderOpacity:.66,enableLabel:!0,labelColor:{theme:"background"},enableBeforeSeparators:!0,beforeSeparatorLength:0,beforeSeparatorOffset:0,enableAfterSeparators:!0,afterSeparatorLength:0,afterSeparatorOffset:0,annotations:[],isInteractive:!0,currentPartSizeExtension:0,role:"img",animate:r.motionDefaultProps.animate,motionConfig:r.motionDefaultProps.config},f=function(e){var r=e.part;return s.jsx(i.BasicTooltip,{id:r.data.label,value:r.formattedValue,color:r.color,enableChip:!0})},h=function(e,r){var o=t.area();return"vertical"===r?o.curve("smooth"===e?t.curveBasis:t.curveLinear).x0((function(e){return e.x0})).x1((function(e){return e.x1})).y((function(e){return e.y})):o.curve("smooth"===e?t.curveBasis:t.curveLinear).y0((function(e){return e.y0})).y1((function(e){return e.y1})).x((function(e){return e.x})),[o,t.line().defined((function(e){return null!==e})).x((function(e){return e.x})).y((function(e){return e.y})).curve("smooth"===e?t.curveBasis:t.curveLinear)]},v=function(e){var r,t,n=e.data,a=e.direction,i=e.width,s=e.height,u=e.spacing;"vertical"===a?(r=s,t=i):(r=i,t=s);var p=(r-u*(n.length-1))/n.length,l=function(e){return u*e+p*e};l.bandwidth=p;var d=n.map((function(e){return e.value}));return[l,o.scaleLinear().domain([0,Math.max.apply(Math,d)]).range([0,t])]},x=function(e){var r=e.parts,t=e.direction,o=e.width,n=e.height,a=e.spacing,i=e.enableBeforeSeparators,s=e.beforeSeparatorOffset,u=e.enableAfterSeparators,p=e.afterSeparatorOffset,l=[],c=[],f=r[r.length-1];if("vertical"===t){r.forEach((function(e){var r=e.y0-a/2;i&&l.push({partId:e.data.id,x0:0,x1:e.x0-s,y0:r,y1:r}),u&&c.push({partId:e.data.id,x0:e.x1+p,x1:o,y0:r,y1:r})}));var h=f.y1;i&&l.push(d({},l[l.length-1],{partId:"none",y0:h,y1:h})),u&&c.push(d({},c[c.length-1],{partId:"none",y0:h,y1:h}))}else if("horizontal"===t){r.forEach((function(e){var r=e.x0-a/2;l.push({partId:e.data.id,x0:r,x1:r,y0:0,y1:e.y0-s}),c.push({partId:e.data.id,x0:r,x1:r,y0:e.y1+p,y1:n})}));var v=f.x1;l.push(d({},l[l.length-1],{partId:"none",x0:v,x1:v})),c.push(d({},c[c.length-1],{partId:"none",x0:v,x1:v}))}return[l,c]},y=function(r){var t=r.parts,o=r.setCurrentPartId,n=r.isInteractive,a=r.onMouseEnter,i=r.onMouseLeave,s=r.onMouseMove,u=r.onClick,p=r.showTooltipFromEvent,l=r.hideTooltip,c=r.tooltip,h=void 0===c?f:c;return n?t.map((function(r){return d({},r,{onMouseEnter:function(t){o(r.data.id),p(e.createElement(h,{part:r}),t),void 0!==a&&a(r,t)},onMouseLeave:function(e){o(null),l(),void 0!==i&&i(r,e)},onMouseMove:function(t){p(e.createElement(h,{part:r}),t),void 0!==s&&s(r,t)},onClick:void 0!==u?function(e){u(r,e)}:void 0})})):t},b=function(e,r){if("function"==typeof e)return e;if(Array.isArray(e)){var t=o.scaleOrdinal(e);return function(e){return Number(t(String(e.id)))}}if(u(e)){if(function(e){return void 0!==e.datum}(e))return function(r){var t=p(r,e.datum);return"number"==typeof t?t:0};throw new Error("Invalid size, when using an object, you should specify a 'datum' property")}return function(e){return r(e.value)}},m=function(r,t){return e.useMemo((function(){return b(r,t)}),[r,t])},g=function(t){var o,a,s=t.data,u=t.width,p=t.height,l=t.direction,f=void 0===l?c.direction:l,b=t.interpolation,g=void 0===b?c.interpolation:b,S=t.spacing,C=void 0===S?c.spacing:S,P=t.shapeBlending,M=void 0===P?c.shapeBlending:P,O=t.valueFormat,j=t.colors,L=void 0===j?c.colors:j,I=t.size,w=void 0===I?c.size:I,B=t.fillOpacity,E=void 0===B?c.fillOpacity:B,W=t.borderWidth,z=void 0===W?c.borderWidth:W,F=t.borderColor,A=void 0===F?c.borderColor:F,G=t.borderOpacity,k=void 0===G?c.borderOpacity:G,q=t.labelColor,T=void 0===q?c.labelColor:q,D=t.enableBeforeSeparators,V=void 0===D?c.enableBeforeSeparators:D,H=t.beforeSeparatorLength,R=void 0===H?c.beforeSeparatorLength:H,N=t.beforeSeparatorOffset,J=void 0===N?c.beforeSeparatorOffset:N,K=t.enableAfterSeparators,Q=void 0===K?c.enableAfterSeparators:K,U=t.afterSeparatorLength,X=void 0===U?c.afterSeparatorLength:U,Y=t.afterSeparatorOffset,Z=void 0===Y?c.afterSeparatorOffset:Y,$=t.isInteractive,_=void 0===$?c.isInteractive:$,ee=t.currentPartSizeExtension,re=void 0===ee?c.currentPartSizeExtension:ee,te=t.currentBorderWidth,oe=t.onMouseEnter,ne=t.onMouseMove,ae=t.onMouseLeave,ie=t.onClick,se=t.tooltip,ue=r.useTheme(),pe=n.useOrdinalColorScale(L,"id"),le=n.useInheritedColor(A,ue),de=n.useInheritedColor(T,ue),ce=r.useValueFormatter(O),fe=e.useMemo((function(){return h(g,f)}),[g,f]),he=fe[0],ve=fe[1],xe=V?R+J:0,ye=Q?X+Z:0;"vertical"===f?(o=u-xe-ye,a=p):(o=u,a=p-xe-ye);var be=e.useMemo((function(){return v({data:s,direction:f,width:o,height:a,spacing:C})}),[s,f,o,a,C]),me=be[0],ge=be[1],Se=m(w,ge),Ce=e.useState(null),Pe=Ce[0],Me=Ce[1],Oe=e.useMemo((function(){var e=s.map((function(e,r){var t,n,i,s,u=e.id===Pe,p=Se(e);"vertical"===f?(t=p,n=me.bandwidth,s=xe+.5*(o-t),i=me(r)):(t=me.bandwidth,n=p,s=me(r),i=xe+.5*(a-n));var l=s+t,d=s+.5*t,c=i+n,h=i+.5*n,v={data:e,width:t,height:n,color:pe(e),fillOpacity:E,borderWidth:u&&void 0!==te?te:z,borderOpacity:k,formattedValue:ce(e.value),isCurrent:u,x:d,x0:s,x1:l,y:h,y0:i,y1:c,borderColor:"",labelColor:"",points:[],areaPoints:[],borderPoints:[]};return v.borderColor=le(v),v.labelColor=de(v),v})),r=M/2;return e.forEach((function(t,o){var n=e[o+1];if("vertical"===f){t.points.push({x:t.x0,y:t.y0}),t.points.push({x:t.x1,y:t.y0}),n?(t.points.push({x:n.x1,y:t.y1}),t.points.push({x:n.x0,y:t.y1})):(t.points.push({x:t.points[1].x,y:t.y1}),t.points.push({x:t.points[0].x,y:t.y1})),t.isCurrent&&(t.points[0].x-=re,t.points[1].x+=re,t.points[2].x+=re,t.points[3].x-=re),t.areaPoints=[{x:0,x0:t.points[0].x,x1:t.points[1].x,y:t.y0,y0:0,y1:0}],t.areaPoints.push(d({},t.areaPoints[0],{y:t.y0+t.height*r}));var a={x:0,x0:t.points[3].x,x1:t.points[2].x,y:t.y1,y0:0,y1:0};t.areaPoints.push(d({},a,{y:t.y1-t.height*r})),t.areaPoints.push(a),[0,1,2,3].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x0,y:t.areaPoints[e].y})})),t.borderPoints.push(null),[3,2,1,0].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x1,y:t.areaPoints[e].y})}))}else{t.points.push({x:t.x0,y:t.y0}),n?(t.points.push({x:t.x1,y:n.y0}),t.points.push({x:t.x1,y:n.y1})):(t.points.push({x:t.x1,y:t.y0}),t.points.push({x:t.x1,y:t.y1})),t.points.push({x:t.x0,y:t.y1}),t.isCurrent&&(t.points[0].y-=re,t.points[1].y-=re,t.points[2].y+=re,t.points[3].y+=re),t.areaPoints=[{x:t.x0,x0:0,x1:0,y:0,y0:t.points[0].y,y1:t.points[3].y}],t.areaPoints.push(d({},t.areaPoints[0],{x:t.x0+t.width*r}));var i={x:t.x1,x0:0,x1:0,y:0,y0:t.points[1].y,y1:t.points[2].y};t.areaPoints.push(d({},i,{x:t.x1-t.width*r})),t.areaPoints.push(i),[0,1,2,3].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x,y:t.areaPoints[e].y0})})),t.borderPoints.push(null),[3,2,1,0].map((function(e){t.borderPoints.push({x:t.areaPoints[e].x,y:t.areaPoints[e].y1})}))}})),e}),[s,f,ge,me,o,a,xe,ye,M,pe,ce,le,de,Pe]),je=i.useTooltip(),Le=je.showTooltipFromEvent,Ie=je.hideTooltip,we=e.useMemo((function(){return y({parts:Oe,setCurrentPartId:Me,isInteractive:_,onMouseEnter:oe,onMouseLeave:ae,onMouseMove:ne,onClick:ie,showTooltipFromEvent:Le,hideTooltip:Ie,tooltip:se})}),[Oe,Me,_,oe,ae,ne,ie,Le,Ie,se]),Be=e.useMemo((function(){return x({parts:Oe,direction:f,width:u,height:p,spacing:C,enableBeforeSeparators:V,beforeSeparatorOffset:J,enableAfterSeparators:Q,afterSeparatorOffset:Z})}),[Oe,f,u,p,C,V,J,Q,Z]),Ee=Be[0],We=Be[1],ze=e.useMemo((function(){return{width:u,height:p,parts:we,areaGenerator:he,borderGenerator:ve,beforeSeparators:Ee,afterSeparators:We,setCurrentPartId:Me}}),[u,p,we,he,ve,Ee,We,Me]);return{parts:we,areaGenerator:he,borderGenerator:ve,beforeSeparators:Ee,afterSeparators:We,setCurrentPartId:Me,currentPartId:Pe,customLayerProps:ze}},S=function(e,r){return a.useAnnotations({data:e,annotations:r,getPosition:function(e){return{x:e.x,y:e.y}},getDimensions:function(e){var r=e.width,t=e.height;return{size:Math.max(r,t),width:r,height:t}}})},C=function(e){var t=e.part,o=e.areaGenerator,n=e.borderGenerator,a=r.useMotionConfig(),i=a.animate,u=a.config,p=r.useAnimatedPath(o(t.areaPoints)),d=r.useAnimatedPath(n(t.borderPoints)),c=l.useSpring({areaColor:t.color,borderWidth:t.borderWidth,borderColor:t.borderColor,config:u,immediate:!i});return s.jsxs(s.Fragment,{children:[t.borderWidth>0&&s.jsx(l.animated.path,{d:d,stroke:c.borderColor,strokeWidth:c.borderWidth,strokeOpacity:t.borderOpacity,fill:"none"}),s.jsx(l.animated.path,{d:p,fill:c.areaColor,fillOpacity:t.fillOpacity,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,onMouseMove:t.onMouseMove,onClick:t.onClick})]})},P=function(e){var r=e.parts,t=e.areaGenerator,o=e.borderGenerator;return s.jsx(s.Fragment,{children:r.map((function(e){return s.jsx(C,{part:e,areaGenerator:t,borderGenerator:o},e.data.id)}))})},M=function(e){var t=e.part,o=r.useTheme(),n=r.useMotionConfig(),a=n.animate,i=n.config,u=l.useSpring({transform:"translate("+t.x+", "+t.y+")",color:t.labelColor,config:i,immediate:!a});return s.jsx(l.animated.g,{transform:u.transform,children:s.jsx(l.animated.text,{textAnchor:"middle",dominantBaseline:"central",style:d({},o.labels.text,{fill:u.color,pointerEvents:"none"}),children:t.formattedValue})})},O=function(e){var r=e.parts;return s.jsx(s.Fragment,{children:r.map((function(e){return s.jsx(M,{part:e},e.data.id)}))})},j=function(e){var t=e.separator,o=r.useTheme(),n=r.useMotionConfig(),a=n.animate,i=n.config,u=l.useSpring({x1:t.x0,x2:t.x1,y1:t.y0,y2:t.y1,config:i,immediate:!a});return s.jsx(l.animated.line,d({x1:u.x1,x2:u.x2,y1:u.y1,y2:u.y2,fill:"none"},o.grid.line))},L=function(e){var r=e.beforeSeparators,t=e.afterSeparators;return s.jsxs(s.Fragment,{children:[r.map((function(e){return s.jsx(j,{separator:e},e.partId)})),t.map((function(e){return s.jsx(j,{separator:e},e.partId)}))]})},I=function(e){var r=e.parts,t=e.annotations,o=S(r,t);return s.jsx(s.Fragment,{children:o.map((function(e,r){return s.jsx(a.Annotation,d({},e),r)}))})},w=["isInteractive","animate","motionConfig","theme","renderWrapper"],B=function(t){var o=t.data,n=t.width,a=t.height,i=t.margin,u=t.direction,p=void 0===u?c.direction:u,l=t.interpolation,d=void 0===l?c.interpolation:l,f=t.spacing,h=void 0===f?c.spacing:f,v=t.shapeBlending,x=void 0===v?c.shapeBlending:v,y=t.valueFormat,b=t.colors,m=void 0===b?c.colors:b,S=t.size,C=void 0===S?c.size:S,M=t.fillOpacity,j=void 0===M?c.fillOpacity:M,w=t.borderWidth,B=void 0===w?c.borderWidth:w,E=t.borderColor,W=void 0===E?c.borderColor:E,z=t.borderOpacity,F=void 0===z?c.borderOpacity:z,A=t.enableLabel,G=void 0===A?c.enableLabel:A,k=t.labelColor,q=void 0===k?c.labelColor:k,T=t.enableBeforeSeparators,D=void 0===T?c.enableBeforeSeparators:T,V=t.beforeSeparatorLength,H=void 0===V?c.beforeSeparatorLength:V,R=t.beforeSeparatorOffset,N=void 0===R?c.beforeSeparatorOffset:R,J=t.enableAfterSeparators,K=void 0===J?c.enableAfterSeparators:J,Q=t.afterSeparatorLength,U=void 0===Q?c.afterSeparatorLength:Q,X=t.afterSeparatorOffset,Y=void 0===X?c.afterSeparatorOffset:X,Z=t.layers,$=void 0===Z?c.layers:Z,_=t.annotations,ee=void 0===_?c.annotations:_,re=t.isInteractive,te=void 0===re?c.isInteractive:re,oe=t.currentPartSizeExtension,ne=void 0===oe?c.currentPartSizeExtension:oe,ae=t.currentBorderWidth,ie=t.onMouseEnter,se=t.onMouseMove,ue=t.onMouseLeave,pe=t.onClick,le=t.tooltip,de=t.role,ce=void 0===de?c.role:de,fe=t.ariaLabel,he=t.ariaLabelledBy,ve=t.ariaDescribedBy,xe=r.useDimensions(n,a,i),ye=xe.margin,be=xe.innerWidth,me=xe.innerHeight,ge=xe.outerWidth,Se=xe.outerHeight,Ce=g({data:o,width:be,height:me,direction:p,interpolation:d,spacing:h,shapeBlending:x,valueFormat:y,colors:m,size:C,fillOpacity:j,borderWidth:B,borderColor:W,borderOpacity:F,labelColor:q,enableBeforeSeparators:D,beforeSeparatorLength:H,beforeSeparatorOffset:N,enableAfterSeparators:K,afterSeparatorLength:U,afterSeparatorOffset:Y,isInteractive:te,currentPartSizeExtension:ne,currentBorderWidth:ae,onMouseEnter:ie,onMouseMove:se,onMouseLeave:ue,onClick:pe,tooltip:le}),Pe=Ce.areaGenerator,Me=Ce.borderGenerator,Oe=Ce.parts,je=Ce.beforeSeparators,Le=Ce.afterSeparators,Ie=Ce.customLayerProps,we={separators:null,parts:null,annotations:null,labels:null};return $.includes("separators")&&(we.separators=s.jsx(L,{beforeSeparators:je,afterSeparators:Le},"separators")),$.includes("parts")&&(we.parts=s.jsx(P,{parts:Oe,areaGenerator:Pe,borderGenerator:Me},"parts")),null!=$&&$.includes("annotations")&&(we.annotations=s.jsx(I,{parts:Oe,annotations:ee},"annotations")),$.includes("labels")&&G&&(we.labels=s.jsx(O,{parts:Oe},"labels")),s.jsx(r.SvgWrapper,{width:ge,height:Se,margin:ye,role:ce,ariaLabel:fe,ariaLabelledBy:he,ariaDescribedBy:ve,children:$.map((function(r,t){var o;return"function"==typeof r?s.jsx(e.Fragment,{children:e.createElement(r,Ie)},t):null!=(o=null==we?void 0:we[r])?o:null}))})},E=function(e){var t=e.isInteractive,o=void 0===t?c.isInteractive:t,n=e.animate,a=void 0===n?c.animate:n,i=e.motionConfig,u=void 0===i?c.motionConfig:i,p=e.theme,l=e.renderWrapper,f=function(e,r){if(null==e)return{};var t,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],r.indexOf(t)>=0||(n[t]=e[t]);return n}(e,w);return s.jsx(r.Container,{animate:a,isInteractive:o,motionConfig:u,renderWrapper:l,theme:p,children:s.jsx(B,d({isInteractive:o},f))})};exports.Funnel=E,exports.ResponsiveFunnel=function(e){return s.jsx(r.ResponsiveWrapper,{children:function(r){var t=r.width,o=r.height;return s.jsx(E,d({width:t,height:o},e))}})},exports.computePartsHandlers=y,exports.computeScales=v,exports.computeSeparators=x,exports.computeShapeGenerators=h,exports.getSizeGenerator=b,exports.svgDefaultProps=c,exports.useFunnel=g,exports.useFunnelAnnotations=S,exports.useSize=m;
//# sourceMappingURL=nivo-funnel.cjs.js.map
